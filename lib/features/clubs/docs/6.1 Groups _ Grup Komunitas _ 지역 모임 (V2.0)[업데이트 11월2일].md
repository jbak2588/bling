# 6.1 Groups / Grup Komunitas / 지역 모임 (V2.0)\[업데이트 11월2일\]

## 6.1.1 필요성 / Purpose

* 지역 주민들이 취미, 운동, 종교 등 공통 관심사를 중심으로 함께 활동할 수 있는 커뮤니티 그룹을 제안·운영하는 메뉴입니다. 자발적인 커뮤니티 생성을 유도하여 사용자 체류 시간을 극대화하고 지역 기반 네트워킹을 활성화합니다.

## 6.1.2 주요 구성 / Key Components

* ●      **2-Tab UI 구성:**

  * ○      **모임 제안 (Proposals):** "함께해요" 성격의 아이디어 제안 공간.

  * ○      **활동 중인 모임 (Active Clubs):** 정식으로 생성되어 활동하는 모임 목록.

  * ●      **'모임 제안' 게시판 (`ClubProposalModel`):**

  * ○      누구나 모임 아이디어 게시 가능 (예: 자카르타 조깅, 수공예 모임 등).

  * ○      **핵심 필드:** 모임명, 활동 내용, 위치, 카테고리, 대표 이미지.

  * ○      **목표 인원 설정 (`targetMemberCount`):** 제안자가 모임 생성에 필요한 최소 인원(예: 5명)을 설정합니다.

  * ○      **참여 현황:** 현재 참여 인원(`currentMemberCount`)과 참여자 목록(`memberIds`)이 실시간으로 표시됩니다.

  * ●      **'활동 중인 모임' UI (`ClubModel`):**

  * ○      **하이브리드 UI:**

  * 1\. 	**(상단) 내가 가입한 모임:** 사용자가 이미 가입한 모임 목록을 \*\*수평 카로셀(Carousel)\*\*로 제공하여 빠른 접근을 돕습니다.

  * 2\. 	**(하단) 모든 모임 탐색:** 광고(스폰서) 모임이 상단에 노출되는 \*\*수직 리스트(List)\*\*를 제공합니다.

  * ○      **필터 및 정렬:** 카테고리(운동, 예술 등) 필터, 거리순/인기순 정렬을 지원합니다.

## 6.1.3 핵심 시스템 설명 / System Logic

* ●      **모임 제안 및 참여 (`/club_proposals`):**

  * ○      사용자는 '모임 제안하기'(`create_club_screen.dart`)를 통해 '목표 인원'을 설정하여 제안을 등록합니다.

  * ○      다른 사용자가 '제안 참여하기'(`joinClubProposal`)를 누르면 `currentMemberCount`가 1 증가합니다.

  * ●      **그룹 자동 생성 (핵심 로직):**

  * ○      `joinClubProposal` 실행 시, **현재 인원 \>= 목표 인원**이 되었는지 검사합니다.

  * ○      조건 충족 시, `_convertProposalToClub` 함수(Cloud Function 또는 Repository 트랜잭션)가 트리거됩니다.

  * ○      **자동 전환 프로세스:**

  * 1\. 	`ClubProposalModel`의 정보를 기반으로 새로운 `ClubModel` 객체를 생성합니다.

  * 2\. 	`/clubs` 컬렉션에 정식 모임을 등록합니다.

  * 3\. 	모임 전용 채팅방(`chats/{clubId}`)을 자동 생성합니다.

  * 4\. 	기존 참여자(`memberIds`) 전원을 새 모임의 정식 멤버(`/clubs/{clubId}/members`)로 등록합니다.

  * 5\. 	원본 `/club_proposals` 문서를 삭제합니다.

  * ●      **데이터베이스 구조:**

  * ○      `/club_proposals`: 모임 제안 컬렉션.

  * ○      `/clubs`: 정식 모임 컬렉션.

  * ○      `/clubs/{clubId}/members`: 모임 멤버 하위 컬렉션.

  * ○      `/clubs/{clubId}/posts`: 모임 게시글 하위 컬렉션.

## 6.1.4 기술 아키텍처 / Technical Architecture

* ●      **DB 구조:**

  * ○      `/club_proposals`: 제안 모임 (신규)

  * ○      `/clubs`: 실제 생성된 활동 그룹 (필드 추가: `isSponsored`, `adExpiryDate`)

  * ○      `/users/{userId}`: `clubs` (내가 가입한 클럽 ID 리스트) 필드 활용.

  * ●      **Repository (`club_repository.dart`):**

  * ○      `createClubProposal()`: 모임 제안 생성.

  * ○      `joinClubProposal()`: 제안 참여 및 자동 생성 로직 트리거.

  * ○      `_convertProposalToClub()`: 제안을 정식 클럽으로 전환.

  * ○      `getClubProposalsStream()`: '모임 제안' 탭 스트림.

  * ○      `getClubsStream()`: '모든 모임 탐색' 탭 스트림 (스폰서 우선 정렬).

  * ○      `getMyClubsStream()`: '내가 가입한 모임' 카로셀 스트림.

  * ●      **UI (`clubs_screen.dart`):**

  * ○      `DefaultTabController` (또는 수동 `TabController`)를 사용하여 2개의 탭을 관리합니다.

  * ○      `_buildProposalList`: `ClubProposalCard`를 사용한 제안 목록.

  * ○      `_buildActiveClubList`: `_buildMyClubsCarousel`과 `_buildAllActiveClubsList`를 포함하는 하이브리드 UI.

## 6.1.5 수익 모델 및 운영 계획 / Monetization & Ops

* ●      **기본 이용:** 모임 제안 및 생성은 무료.

  * ●      **유료 모델 제안 (V2.0):**

  * ○      **상단 고정 (Sponsor):** `isSponsored: true` 필드를 활성화하여 '활동 중인 모임' 및 '탐색' 리스트 최상단에 고정 노출.

  * ○      **프로 그룹 배지:** 검증된 모임장에게 유료 배지 부여.

  * ○      **제안 부스팅:** '모임 제안' 탭에서 상단 노출.

## 6.1.6 확장성 및 로드맵 / Scalability & Roadmap

* ●      **추천 기능:** 사용자의 위치(GPS) 및 관심사(`interestTags`)를 기반으로 참여할 만한 '모임 제안' 또는 '활동 중인 모임'을 추천.

  * ●      **문화적 최적화:** 종교(이슬람 커뮤니티 등), 스포츠(배드민턴, 축구), 라이프스타일(오토바이 투어) 등 현지 수요가 높은 카테고리 강화.

  * ●      **Jobs 연동:** (구현 완료) `shop_detail_screen.dart`에서 `create_job_screen.dart`로 연동된 것처럼, 향후 '프로 그룹'이 구인 공고를 올릴 수 있도록 연동.

    

---

*지역 모임 메뉴는 단순한 게시판이 아닌, 자발적 커뮤니티 생성 기능이 내장된 확장형 플랫폼입니다. 이 기능은 사용자의 앱 체류 시간을 늘리고, 향후 커뮤니티 광고나 로컬 협업 사업의 중심 허브가 될 수 있습니다.*